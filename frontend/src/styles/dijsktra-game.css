@import url('https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&family=Nunito:wght@700;900&display=swap');

:root {
  --font-head: 'Fredoka', sans-serif;
  --font-body: 'Nunito', sans-serif;
}

/* --- THEME DEFINITIONS --- */
.theme-pak {
  --bg-color: #E0F2F1;
  --bg-pattern: radial-gradient(#80CBC4 2px, transparent 2px);
  --node-bg: #fff; --node-border: #00695C;
  --line-idle: #CFD8DC; --line-active: #00695C;
  --pill-bg: #fff; --pill-text: #00695C;
}

.theme-uet {
  --bg-color: #2c3e50;
  --bg-pattern: linear-gradient(rgba(255,255,255,0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255,255,255,0.05) 1px, transparent 1px);
  --node-bg: #ecf0f1; --node-border: #2980b9;
  --line-idle: #7f8c8d; --line-active: #f1c40f;
  --pill-bg: #34495e; --pill-text: #ecf0f1;
}

.theme-world {
  --bg-color: #0F172A; /* Deep Space Blue */
  --bg-pattern: radial-gradient(circle, #334155 1px, transparent 1px);
  --node-bg: #1E293B; --node-border: #38BDF8;
  --line-idle: #334155; --line-active: #F43F5E;
  --pill-bg: #0F172A; --pill-text: #38BDF8;
}

* { box-sizing: border-box; user-select: none; }
body {
  margin: 0; padding: 0;
  font-family: var(--font-body);
  overflow: hidden; height: 100vh; width: 100vw;
}

/* --- MENU --- */
.menu-screen {
  height: 100vh; display: flex; flex-direction: column;
  justify-content: center; align-items: center;
  background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
}
.game-logo {
  font-family: var(--font-head); font-size: 5rem;
  margin-bottom: 2rem; color: #2d3436;
  text-shadow: 4px 4px 0 #fff; animation: float 3s infinite ease-in-out;
}
.cards-container { display: flex; gap: 20px; flex-wrap: wrap; justify-content: center; }
.level-card {
  width: 220px; background: white; border-radius: 20px;
  padding: 20px; text-align: center; cursor: pointer;
  border: 3px solid #2d3436; box-shadow: 0 8px 0 #b2bec3;
  transition: transform 0.1s;
}
.level-card:hover { transform: translateY(-5px); }
.level-card:active { transform: translateY(0); box-shadow: 0 4px 0 #b2bec3; }

/* --- GAME LAYOUT --- */
.game-layout {
  height: 100vh; display: flex; flex-direction: column; padding: 15px;
  background-color: var(--bg-color);
  background-image: var(--bg-pattern);
  background-size: 40px 40px;
  transition: background-color 0.5s;
}

/* HUD */
.hud-bar {
  display: flex; justify-content: space-between; align-items: center;
  background: white; padding: 10px 20px; border-radius: 20px;
  border: 3px solid #2d3436; box-shadow: 0 4px 0 rgba(0,0,0,0.1);
  margin-bottom: 15px; z-index: 50;
}
.btn-circle {
  width: 45px; height: 45px; border-radius: 50%;
  border: 3px solid #2d3436; background: #f1f2f6;
  display: flex; justify-content: center; align-items: center;
  font-size: 1.2rem; cursor: pointer; margin-right: 10px;
}
.btn-circle:active { transform: scale(0.9); }
.score-board {
  background: #2d3436; color: white; padding: 5px 20px;
  border-radius: 12px; font-family: var(--font-head); font-size: 1.2rem;
}

/* MAP BOARD */
.map-board {
  flex-grow: 1; position: relative;
  background: rgba(255,255,255,0.02); /* Very light tint */
  border-radius: 20px; border: 3px solid rgba(0,0,0,0.1);
  box-shadow: inset 0 0 30px rgba(0,0,0,0.05);
}

/* SVG LAYERS */
.svg-layer {
  position: absolute; top: 0; left: 0; width: 100%; height: 100%;
  pointer-events: none; z-index: 1;
}

/* Lines Layer (Bottom) */
.edge-line {
  stroke: var(--line-idle); stroke-width: 5;
  stroke-linecap: round; stroke-dasharray: 10, 8;
  transition: stroke 0.3s;
}
.edge-line.active {
  stroke: var(--line-active); stroke-width: 7; stroke-dasharray: 0;
  filter: drop-shadow(0 0 4px var(--line-active));
}

/* Labels Layer (Top) */
.cost-group { transition: transform 0.2s; }
.cost-pill {
  fill: var(--pill-bg); stroke: var(--line-idle); stroke-width: 2px;
  rx: 8; ry: 8;
}
.cost-text {
  font-family: var(--font-head); font-weight: bold; font-size: 13px;
  fill: var(--pill-text); text-anchor: middle; dominant-baseline: middle;
}
/* Active label styling */
.cost-group.active .cost-pill { stroke: var(--line-active); stroke-width: 3px; }
.cost-group.active .cost-text { fill: var(--line-active); }

/* NODES */
.node {
  position: absolute; width: 50px; height: 50px;
  transform: translate(-50%, -50%);
  background: var(--node-bg);
  border: 3px solid var(--node-border);
  border-radius: 50%; z-index: 2;
  display: flex; justify-content: center; align-items: center;
  cursor: pointer; transition: transform 0.2s;
  box-shadow: 0 4px 0 rgba(0,0,0,0.2);
}
.node:hover { transform: translate(-50%, -60%) scale(1.1); z-index: 10; }
.node:active { transform: translate(-50%, -50%) scale(0.9); }

.node.start { border-color: #2ecc71; box-shadow: 0 0 15px #2ecc71; }
.node.end { border-color: #e74c3c; animation: pulse 2s infinite; }
.node.current {
  background: #FFCA28; border-color: #fff;
  transform: translate(-50%, -55%) scale(1.3);
  z-index: 20; box-shadow: 0 8px 10px rgba(0,0,0,0.3);
}

.node-label {
  position: absolute; top: 55px;
  background: white; color: #2d3436;
  padding: 3px 8px; border-radius: 8px;
  font-size: 0.75rem; font-weight: 800;
  border: 2px solid #2d3436; white-space: nowrap;
  pointer-events: none; z-index: 20;
}

/* MODAL */
.overlay {
  position: fixed; top: 0; left: 0; width: 100%; height: 100%;
  background: rgba(0,0,0,0.85); z-index: 100;
  display: flex; justify-content: center; align-items: center;
}
.modal {
  background: white; padding: 30px; border-radius: 25px;
  border: 4px solid #2d3436; text-align: center; width: 450px;
  animation: popIn 0.3s ease;
}
.btn-primary {
  background: #0984e3; color: white; border: none;
  padding: 12px 30px; font-family: var(--font-head);
  font-size: 1.2rem; border-radius: 30px; margin-top: 20px;
  cursor: pointer; box-shadow: 0 5px 0 #005aa7;
}
.btn-primary:active { transform: translateY(5px); box-shadow: none; }

@keyframes float { 0%,100%{transform:translateY(0);} 50%{transform:translateY(-10px);} }
@keyframes pulse { 0%{transform:translate(-50%,-50%) scale(1);} 50%{transform:translate(-50%,-50%) scale(1.1);} 100%{transform:translate(-50%,-50%) scale(1);} }
@keyframes popIn { from{transform:scale(0);} to{transform:scale(1);} }